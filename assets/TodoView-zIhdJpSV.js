import{_ as O,u as A,a as B,r as n,o as E,c as g,b as a,d as i,e as t,t as d,w as P,v as V,f as y,F as C,g as m,h as D,n as w,p as F,i as J}from"./index-DiZtQFSK.js";const M=h=>(F("data-v-17411699"),h=h(),J(),h),R={id:"todoListPage",class:"bg-half"},q=M(()=>t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1)),H={class:"todo_sm"},U={class:"conatiner todoListPage vhContainer"},X={class:"todoList_Content"},G={class:"inputBox"},K={key:0},Q={key:1,class:"todoList_list"},W={class:"todoList_tab"},Y=["onClick"],Z={class:"todoList_items"},tt={class:"todoList_item"},et={class:"todoList_label"},st=["onClick","checked"],ot=["onClick"],nt={class:"todoList_statistics"},r="https://todolist-api.hexschool.io",at={__name:"TodoView",setup(h){const c=document.cookie.replace(/(?:(?:^|.*;\s*)todolistCookieName\s*\=\s*([^;]*).*$)|^.*$/,"$1"),L=A(),k=B(),T=n({nickname:L.query.name});E(()=>{c?p():k.push("/LoginPage")});const $=async()=>{try{const e=await D.post(`${r}/users/sign_out`,{},{headers:{authorization:c}});k.push("/")}catch(e){console.log(e.message)}};n("");const l=n([]),_=n({content:""}),p=async()=>{const o=await(await fetch(`${r}/todos`,{headers:{Authorization:c}})).json();l.value=o.data},b=async()=>{p(),await(await fetch(`${r}/todos`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:c},body:JSON.stringify(_.value)})).json(),_.value=""},S=async e=>{const o=e.id;await(await fetch(`${r}/todos/${o}`,{method:"DELETE",headers:{Authorization:c},body:JSON.stringify()})).json(o),p()},x=async e=>{const s=await(await fetch(`${r}/todos/${e}/toggle`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:c}})).json();console.log(s),p()},I=n([{title:"全部"},{title:"待完成"},{title:"已完成"}]),v=n(0),N=g(()=>v.value===1?l.value.filter(e=>e.status==!1):v.value===2?l.value.filter(e=>e.status==!0):l.value),j=g(()=>l.value.filter(o=>o.status==!1).length),f=n(!0),z=g(()=>{if(l.value.length===0)return"目前尚無待辦事項";f.value=!1});return(e,o)=>(a(),i("div",R,[t("nav",null,[q,t("ul",null,[t("li",H,[t("span",null,d(T.value.nickname)+"的代辦",1)]),t("li",null,[t("a",{onClick:$},"登出")])])]),t("div",U,[t("div",X,[t("div",G,[P(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":o[0]||(o[0]=s=>_.value.content=s)},null,512),[[V,_.value.content]]),t("a",{onClick:b}," + ")]),f.value?(a(),i("div",K,d(z.value),1)):y("",!0),f.value?y("",!0):(a(),i("div",Q,[t("ul",W,[(a(!0),i(C,null,m(I.value,(s,u)=>(a(),i("li",{key:u,onClick:it=>v.value=u},[t("a",{class:w({active:v.value===u})},d(s.title),3)],8,Y))),128))]),t("div",Z,[t("ul",tt,[(a(!0),i(C,null,m(N.value,s=>(a(),i("li",{key:s.id},[t("label",et,[t("input",{class:"todoList_input",type:"checkbox",onClick:u=>x(s.id,s.status),checked:s.status},null,8,st),t("span",{class:w({"text-decoration-line-through":s.status})},d(s.content),3)]),t("button",{type:"button",onClick:u=>S(s),class:"btn"},"X",8,ot)]))),128))]),t("div",nt,[t("p",null,d(j.value)+" 個待完成項目",1)])])]))])])]))}},lt=O(at,[["__scopeId","data-v-17411699"]]);export{lt as default};
