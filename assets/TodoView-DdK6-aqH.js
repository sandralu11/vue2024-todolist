import{_ as B,u as O,a as P,r as a,o as V,c as g,b as c,d as l,e as t,t as d,w as A,v as D,f as y,F as C,g as m,h as E,n as L,p as F,i as M}from"./index-CFMk7ZTp.js";const R=r=>(F("data-v-43ac8fff"),r=r(),M(),r),q={id:"todoListPage",class:"bg-half"},H=R(()=>t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1)),J={class:"todo_sm"},U={class:"conatiner todoListPage vhContainer"},X={class:"todoList_Content"},G={class:"inputBox"},K={key:0},Q={key:1,class:"todoList_list"},W={class:"todoList_tab"},Y=["onClick"],Z={class:"todoList_items"},tt={class:"todoList_item"},et={class:"todoList_label"},st=["onClick","checked"],ot=["onClick"],nt={class:"todoList_statistics"},p="https://todolist-api.hexschool.io",at={__name:"TodoView",setup(r){const i=document.cookie.replace(/(?:(?:^|.*;\s*)todolistCookieName\s*\=\s*([^;]*).*$)|^.*$/,"$1"),w=O(),k=P(),T=a({nickname:w.query.name});V(()=>{i?v():k.push("/LoginPage")});const b=async()=>{try{const s=await E.post(`${p}/users/sign_out`,{},{headers:{authorization:i}});k.push("/")}catch(s){console.log(s.message)}};a("");const n=a([]),h=a({content:""}),v=async()=>{const o=await(await fetch(`${p}/todos`,{headers:{Authorization:i}})).json();n.value=o.data,console.log(n.value)},x=async()=>{v();const o=await(await fetch(`${p}/todos`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:i},body:JSON.stringify(h.value)})).json();console.log(o),h.value=""},$=s=>{const o=n.value.findIndex(e=>e.id===s.id);n.value.splice(o,1)},S=async s=>{const e=await(await fetch(`${p}/todos/${s}/toggle`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:i}})).json();console.log(e),v()},I=a([{title:"全部"},{title:"待完成"},{title:"已完成"}]),_=a(0),N=g(()=>_.value===1?n.value.filter(s=>s.status==!1):_.value===2?n.value.filter(s=>s.status==!0):n.value),j=g(()=>n.value.filter(o=>o.status==!1).length),f=a(!0),z=g(()=>{if(n.value.length===0)return"目前尚無待辦事項";f.value=!1});return(s,o)=>(c(),l("div",q,[t("nav",null,[H,t("ul",null,[t("li",J,[t("span",null,d(T.value.nickname)+"的代辦",1)]),t("li",null,[t("a",{onClick:b},"登出")])])]),t("div",U,[t("div",X,[t("div",G,[A(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":o[0]||(o[0]=e=>h.value.content=e)},null,512),[[D,h.value.content]]),t("a",{onClick:x}," + ")]),f.value?(c(),l("div",K,d(z.value),1)):y("",!0),f.value?y("",!0):(c(),l("div",Q,[t("ul",W,[(c(!0),l(C,null,m(I.value,(e,u)=>(c(),l("li",{key:u,onClick:ct=>_.value=u},[t("a",{class:L({active:_.value===u})},d(e.title),3)],8,Y))),128))]),t("div",Z,[t("ul",tt,[(c(!0),l(C,null,m(N.value,e=>(c(),l("li",{key:e.id},[t("label",et,[t("input",{class:"todoList_input",type:"checkbox",onClick:u=>S(e.id,e.status),checked:e.status},null,8,st),t("span",{class:L({"text-decoration-line-through":e.status})},d(e.content),3)]),t("button",{type:"button",onClick:u=>$(e),class:"btn"},"X",8,ot)]))),128))]),t("div",nt,[t("p",null,d(j.value)+" 個待完成項目",1)])])]))])])]))}},it=B(at,[["__scopeId","data-v-43ac8fff"]]);export{it as default};
